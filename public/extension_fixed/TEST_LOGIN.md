# Whatsub 확장 프로그램 로그인 테스트 가이드

이 문서는 Whatsub 확장 프로그램의 로그인 기능을 테스트하는 방법을 설명합니다.

## 준비 사항

1. Chrome 브라우저가 설치되어 있어야 합니다.
2. Whatsub 확장 프로그램이 개발자 모드로 로드되어 있어야 합니다.
3. 테스트에 사용할 Google 계정이 준비되어 있어야 합니다.

## 테스트 계정 설정

테스트에 사용할 계정은 다음과 같습니다:

- 테스트 계정 1: whatsub.test1@gmail.com (또는 실제 사용 가능한 테스트 이메일 계정)
- 테스트 계정 2: whatsub.test2@gmail.com (또는 실제 사용 가능한 테스트 이메일 계정)

> 참고: 실제 테스트에는 접근 가능한 Google 계정을 사용해야 합니다. 위의 계정은 예시일 뿐입니다.

## 테스트 방법

### 방법 1: 팝업 인터페이스를 통한 수동 테스트

1. Chrome 브라우저에서 Whatsub 확장 프로그램 아이콘을 클릭합니다.
2. 팝업이 열리면 "Google로 로그인" 버튼을 클릭합니다.
3. Google 로그인 창이 열리면 테스트 계정 정보를 입력하고 로그인 절차를 완료합니다.
4. 로그인 후 팝업에 사용자 정보가 표시되는지 확인합니다.
5. "로그아웃" 버튼을 클릭하여 로그아웃이 제대로 작동하는지 확인합니다.

### 방법 2: 자동화된 테스트 스크립트 사용

확장 프로그램에는 로그인/로그아웃 기능을 테스트할 수 있는 자동화된 스크립트가 포함되어 있습니다:

1. Chrome 브라우저에서 Whatsub 확장 프로그램 아이콘을 클릭합니다.
2. 팝업이 열리면 팝업 창에서 마우스 오른쪽 버튼을 클릭하고 "검사"를 선택합니다.
3. 개발자 도구가 열리면 "콘솔" 탭을 클릭합니다.
4. 콘솔에서 다음 명령어 중 하나를 실행합니다:

```javascript
// Google 로그인 테스트
testGoogleLogin();

// 로그아웃 테스트
testLogout();

// 전체 로그인/로그아웃 테스트 (로그인 후 5초 뒤 자동으로 로그아웃)
runFullLoginTest();
```

5. 콘솔에 출력되는 결과를 확인합니다. 성공적인 테스트는 다음과 같은 메시지를 표시합니다:
   - 로그인 성공: `[테스트] 로그인 성공! {사용자 정보 객체}`
   - 로그아웃 성공: `[테스트] 로그아웃 성공!`

## 테스트 중 발생할 수 있는 문제 해결

### 문제 1: "Google 로그인 버튼을 찾을 수 없습니다" 오류

- 확장 프로그램이 올바르게 로드되었는지 확인합니다.
- 팝업 HTML에 `id="google-signin"`인 요소가 있는지 확인합니다.

### 문제 2: "로그인 시간 초과" 오류

- 인터넷 연결 상태를 확인합니다.
- Google 개발자 콘솔에서 OAuth 클라이언트 ID 설정이 올바른지 확인합니다.
- manifest.json 파일에 클라이언트 ID가 올바르게 설정되어 있는지 확인합니다.

### 문제 3: "리디렉션 URI 불일치" 오류

- Google 개발자 콘솔에 등록된 리디렉션 URI가 확장 프로그램에서 사용하는 URI와 일치하는지 확인합니다.
- 콘솔 로그에서 `chrome.identity.getRedirectURL('oauth2')`의 출력값을 확인하고, 이 값이 Google 개발자 콘솔에 등록되어 있는지 확인합니다.

## 로그 확인 방법

테스트 과정에서 발생하는 로그와 오류를 확인하는 방법:

1. 확장 프로그램 팝업 개발자 도구의 콘솔 탭에서 로그를 확인합니다.
2. 배경 페이지 로그를 확인하려면:
   - `chrome://extensions`로 이동합니다.
   - Whatsub 확장 프로그램에서 "백그라운드 페이지 검사" 링크를 클릭합니다.
   - 콘솔 탭에서 로그를 확인합니다.

## 테스트 계정 사용 시 주의사항

- 테스트 계정은 실제 Google 계정이어야 합니다.
- 테스트 계정의 로그인 활동이 기록될 수 있으므로, 중요한 작업에 사용하는 계정은 피하는 것이 좋습니다.
- 테스트 후에는 항상 로그아웃하여 보안을 유지하세요.
- 개발 중에만 테스트 스크립트를 사용하고, 배포 버전에서는 제거하는 것이 좋습니다.

## 추가 정보

- 로그인 관련 코드는 `background.js`와 `lib/firebase-sdk.js` 파일에서 찾을 수 있습니다.
- 테스트 스크립트는 `test-login.js` 파일에 있습니다.
- 로그인 UI 관련 코드는 `popup.html`과 `popup.js` 파일에서 찾을 수 있습니다. 