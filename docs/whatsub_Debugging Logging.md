# 디버깅 및 로깅 정책 문서

## 1. 개요
이 문서는 크롬 확장 프로그램 기반 실시간 자막 서비스의 디버깅 및 로깅 정책을 정의합니다.
안정적인 서비스 운영을 위해 오류를 신속하게 감지하고 해결할 수 있도록 다양한 로그 수집 및 분석 방법을 명시합니다.

---

## 2. 로깅 정책

### 2.1 로그 레벨
로그는 중요도에 따라 다음과 같이 분류됩니다.

- **DEBUG**: 개발 단계에서 상세한 디버깅 정보를 기록. (예: API 요청, 사용자 이벤트, UI 인터랙션)
- **INFO**: 일반적인 운영 정보 및 정상적인 상태 변경 사항을 기록. (예: 사용자 로그인, 설정 변경, 자막 업로드 등)
- **WARN**: 잠재적인 문제 또는 예외적인 상황이 발생했지만, 서비스에 즉각적인 영향을 주지 않는 경우 기록. (예: 네트워크 지연, API 응답 오류 등)
- **ERROR**: 시스템 오류, 예외 발생 등 서비스에 직접적인 영향을 미치는 경우 기록. (예: 자막 렌더링 실패, API 통신 실패)
- **FATAL**: 치명적인 오류로 인해 서비스가 정상 작동할 수 없는 경우 기록. (예: 데이터베이스 연결 끊김, 크리티컬 프로세스 종료)

### 2.2 로그 저장소 및 보존 정책
- **클라이언트 로그**: 브라우저 LocalStorage 또는 IndexedDB에 저장하며, 최대 7일간 유지.
- **서버 로그**: 중앙 로그 서버에 저장하며, 30일간 보관 후 자동 삭제.
- **에러 및 크리티컬 로그**: 장기 분석을 위해 6개월간 저장 후 보관 정책에 따라 백업.
- **사용자 이벤트 로그**: 분석 목적으로 90일간 저장 후 익명화 처리.

### 2.3 로그 저장 방식
- **JSON 기반의 구조화된 로그 저장** (예시)
  ```json
  {
    "timestamp": "2025-03-05T12:34:56Z",
    "level": "ERROR",
    "component": "SubtitleRenderer",
    "message": "자막 렌더링 실패",
    "details": {
      "error_code": 500,
      "file": "subtitle_processor.js",
      "line": 234
    }
  }
  ```
- **로그 파일 회전 (Log Rotation)**: 로그 크기가 10MB를 초과하면 자동으로 새로운 파일을 생성하며, 최대 10개의 로그 파일 유지.

---

## 3. 디버깅 정책

### 3.1 Debug Mode 활성화
- 개발 환경 및 문제 발생 시 Debug Mode를 활성화하여 추가적인 로그 수집 가능.
- Debug Mode 활성화 방법:
  - 크롬 확장 프로그램의 설정 페이지에서 `Debug Mode` 활성화 옵션 추가.
  - 개발자 콘솔에서 `window.debugMode = true` 설정 가능.

### 3.2 디버깅 로그 수집 항목
- **네트워크 요청 및 응답 로그** (API 호출 및 응답 시간 포함)
- **사용자 이벤트 로그** (자막 변경, 싱크 조절, 재생/일시정지 등)
- **자막 렌더링 오류 로그** (브라우저, OS, 확장 프로그램 버전 포함)
- **메모리 및 성능 모니터링 로그** (CPU 사용량, 메모리 소비량 기록)

### 3.3 자동 오류 감지 및 보고
- **Sentry** 또는 **Rollbar** 같은 오류 추적 도구를 활용하여 실시간 에러 감지.
- 주요 오류 발생 시 관리자에게 Slack, 이메일 또는 Webhook을 통해 알림 전송.
- **사용자 피드백 시스템**: 사용자가 오류 발생 시 직접 로그를 제출할 수 있도록 UI 제공.

---

## 4. 대응 방법

### 4.1 일반적인 오류 대응 절차
1. **이슈 감지**: 실시간 로그 모니터링 시스템을 통해 오류 감지.
2. **분석 및 원인 파악**: 로그 데이터 및 오류 리포트 분석.
3. **핫픽스 배포**: 긴급 패치가 필요한 경우 Hotfix 배포 진행.
4. **사용자 공지**: 필요 시 서비스 상태 페이지 또는 알림을 통해 사용자에게 공지.

### 4.2 장애 대응 시나리오
| 장애 유형 | 대응 조치 |
|-----------|-----------------------------|
| API 통신 실패 | 재시도 로직 적용, 백업 서버 사용 |
| 자막 렌더링 오류 | Debug Mode 활성화 후 원인 분석 |
| 네트워크 지연 | 로딩 UI 추가, 사용자 피드백 제공 |
| DB 연결 실패 | Failover 시스템 적용, 캐싱 활용 |
| 확장 프로그램 충돌 | 버전 롤백 및 긴급 패치 적용 |

---

## 5. 결론
디버깅 및 로깅 정책은 실시간 자막 서비스의 안정성을 유지하는 중요한 요소입니다. 본 문서를 기반으로 체계적인 로그 관리 및 신속한 문제 대응이 이루어질 수 있도록 지속적인 모니터링과 개선을 진행해야 합니다.

